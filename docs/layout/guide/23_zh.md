# 第 23 章 与机械设计团队的数据交换

在 `SailWind Layout` 中使用 MCAD Collaborator 工具可以在 PCB 设计团队和机械设计团队之间传输、记录、管理和预览变更请求。

## 支持的数据交换对象

MCAD Collaborator 支持使用 IDX Schema 2.0 或 3.0 格式处理和交换设计对象。

以下表格列出了各种设计对象及其在 IDX Schema 2.0 和 3.0 中的支持情况。


> [!danger] 
您不能通过应用 IDX Schema 3.0 基线文件然后从中导出 IDX Schema 2.0 提案来进行协作。

| 设计对象               | IDX 2.0 |
| ---------------------- | ------- |
| 单板                   |         |
| 开孔                   | 是      |
| 走线                   |         |
| 通过基线导出外部层数据 | 是      |
| 焊盘                   |         |
| 通过基线导出外部层数据 | 是      |
| 过孔                   |         |

**表 105. IDX Schema 2.0 支持的对象**

| 设计对象                       | IDX 2.0 |
| ------------------------------ | ------- |
| 通过基线导出通孔               | 是      |
| 元件管脚/管脚孔/安装孔         |         |
| 通过基线导出一个元件管脚的位置 | 是      |

**表 105. IDX Schema 2.0 支持的对象(续)**

对于 IDX 3.0，对象在不同协作流程中的支持情况如下：

- **导出** 表示您可以以 IDX 3.0 格式导出此数据并保存为基线文件。

- **协作** 表示您可以导入和导出这些对象。Collaborator 会跟踪它们，以便您可以发送和接收对象的更新(添加、删除、更改)。

| 设计对象       | IDX 3.0 |      |
| -------------- | ------- | ---- |
|                | 导出    | 协作 |
| 板级对象       |         |      |
| 板轮廓         | 是      | 是   |
| 板厚           | 是      | 否   |
| 板堆叠         | 是      | 否   |
| 通孔安装孔     | 是      | 是   |
| 开孔(轮廓)     | 是      | 是   |
| 腔体           | 是      | 是   |
| 铜层           |         |      |
| 走线           | 是      | 是   |
| 平面(区域填充) | 是      | 是   |
| 过孔焊盘       | 是      | 否   |
| 过孔孔         | 是      | 否   |
| 盲埋孔         | 是      | 否   |
| 基准点         | 是      | 否   |
| 元件特征       |         |      |
| 电气元件       | 是      | 是   |

**表 106. IDX Schema 3.0 支持的对象**

|                       | IDX 3.0 |             |
|-----------------------|---------|-------------|
| 设计对象              | 导出    | 协作        |
| 机械元件              | 是      | 是          |
| 元件焊盘              | 是      | 否          |
| 元件管脚孔            | 是      | 否          |
| 主管脚                | 是      | 否          |
| 禁止区域              |         |             |
| 布局禁止区域          | 是      | 是          |
| 平面禁止区域          | 是      | 是          |
| 走线禁止区域          | 是      | 是          |
| 过孔禁止区域          | 是      | 是          |

**表 106. IDX Schema 3.0 支持的对象(续)**

**数据交换对象使用指南**

板轮廓/板厚：

- MCAD Collaborator 显示的板厚与堆叠厚度不同。Collaborator 在厚度计算中不包括阻焊层，因此它表示正确的零件安装(零件实际安装在铜层上)。堆叠厚度减去阻焊层厚度应等于 MCAD Collaborator 中显示的板厚。

元件管脚/管脚孔/安装孔：

- IDX 格式包含元件第一管脚位置的信息。

第一管脚的坐标显示在属性部分。第一管脚坐标位置的报告是相对于元件原点，而不是板原点。这有助于对齐模型。

## 协作工作流程图

典型的协作工作流程包括设置协作会话、建立共同设计基线，然后交换机械变更请求。

您可以通过打开协作会话并向机械设计团队提交基线数据文件来启动交换流程(或者他们通过向您提交基线文件来启动流程)。基线和变更数据文件采用 IDX 格式。基线文件用变更更新设计；您没有拒绝基线文件中提议变更的选项。接收提案的一方可以选择接受或拒绝提议的变更。然后任何一方都可以通过共享新的变更数据文件来创建和提交额外的提案。

您可以通过电子邮件或将数据文件存储在两个团队都可访问的公共目录中来交换数据文件。任何团队都可以发起变更，变更请求由另一个团队批准或拒绝。MCAD Collaborator 保存并跟踪每个变更请求的状态，以便您持续记录已完成的工作。一旦变更请求已发送并接收，您可以关闭协作会话。

![](/layout/guide/23/_page_3_Figure_2.jpeg)

**图 52. 典型协作工作流程图**

## 启动协作工具

从 `SailWind Layout` 中的 SailWind 3D 窗口启动协作工具。

🏃‍♂️‍**步骤**

1. 在 `SailWind Layout` 的设计中，打开 SailWind 3D(视图 > SailWind 3D)。

   SailWind 3D 打开并显示 3D 通用工具栏。

2. 点击工具栏上的**MCAD Collaborator**按钮打开 MCAD Collaborator。

👀‍**结果**

您已准备好设置协作会话。

## 设置协作会话

在传输变更之前，设置协作会话并定义您希望如何与机械设计团队交换数据。

🙊**限制和约束**

- 您必须命名(或重命名)所有元件和零件名称，使其不包含空格或非字母数字字符。如果您向机械设计团队发送的名称中包含空格或非字母数字字符的数据文件，这些字符将自动替换为下划线。名称中的这些自动更改随后会被标记为修改，即使实际上没有发生设计变更。

🏃‍♂️‍**步骤**

1. 在 MCAD Collaborator 中，展开通信部分。

2. 在写入选项部分，从下拉列表中选择所需的输出和电子邮件通知选项。

3. 从数据传输下拉列表中选择以下选项之一来定义您希望如何交换基线和变更请求文件：

    | 如果您想要                        | 执行以下操作                                                                                     |
    |-----------------------------------|------------------------------------------------------------------------------------------------|
    | 通过将数据文件存储在共享目录中交换 | 1. 从下拉列表中选择文件。                                                                       |
    |                                   | 2. 在数据路径文本框中，输入要存储数据交换文件的目录的路径名(或浏览定位目录)。                   |

    | 如果您想要               | 执行以下操作                                                                                  |
    |--------------------------|---------------------------------------------------------------------------------------------|
    | 通过电子邮件附件交换数据文件 | 1. 从下拉列表中选择电子邮件。                                                                |
    |                          | 2. 从电子邮件服务器下拉列表中选择 Outlook 或 SMTP。                                             |
    |                          | 3. 在接收者信息和发送者信息文本框中输入适当的联系信息。                                      |

4. 点击**过滤对象**打开对象过滤器对话框。

5. 在元件选项部分，执行以下操作以指定如何生成元件数据：

    - 勾选"写入安装孔"以生成作为封装一部分的安装孔数据。

    - 勾选"写入管脚孔"以生成作为封装一部分的管脚孔数据。

    - 在"将零高度元件替换为"下，勾选"顶部或底部铜厚"或输入自定义高度。
    
    > [!warning]     
    协作交换可能无法正确传输零高度值。通过为零高度元件定义默认高度，您可以避免可能出现在机械设计交换端的潜在错误。
    
6. 在板选项部分，勾选写入开孔(轮廓和腔体)以包含开孔。

7. 在协作对象过滤器列表中，通过勾选所需对象类型来过滤协作数据列表中显示的内容。(未勾选的对象类型不会出现在协作数据列表中。)

8. 点击**确定**保存对象过滤器设置并关闭对话框。

    > [!warning] 
    如果您更改了协作对象过滤器列表，MCAD Collaborator 中的**更新树数据**按钮将变为黄色。点击**更新树数据**以更新协作数据列表。

9. (可选)在方案部分，点击**保存**并输入方案名称以保存您定义的设置，以便以后在其他设计中重复使用。

通信和对象过滤器设置将作为方案保存在您指定的目录中。

👀‍**结果**

协作数据列表显示您在对象过滤器列表中勾选的设计对象。

协作设置与您的设计项目一起存储。

您已准备好发送基线请求。


## 发送基线请求

通过创建并向机械设计团队发送基线请求来启动协作会话。

基线请求建立 PCB 设计团队和机械设计团队共享的公共数据库，以便两者同步。未来的变更请求将参考基线数据。

**前提条件**

- 已设置定义如何交换请求信息的协作会话。参见第 565 页的"设置协作会话"。

🏃‍♂️‍**步骤**

1. 在 MCAD Collaborator 中，从文件类型选择器下拉列表中选择基线。

2. 点击**对象过滤器**打开对象过滤器对话框。

    a. 勾选您要应用的元件选项。

    a. 在协作对象过滤器列表中，通过勾选所需对象类型来过滤协作数据列表中显示的内容。(未勾选的对象类型不会出现在协作数据列表中。)

    a. (可选)在板选项部分，取消勾选"写入开孔(轮廓和腔体)"以仅发送不带开孔和轮廓数据的板轮廓。

    a. 点击**确定**应用设置并关闭对象过滤器对话框。
    
    > [!warning]
    >
    > 如果您更改了协作对象过滤器列表，MCAD Collaborator 中的**更新树数据**按钮将变为黄色。点击**更新树数据**以使用您在对象过滤器对话框中勾选的对象更新协作数据列表。
    >
    > 主设计项的属性部分显示文件类型为"基线"，状态为"待发送"。
    >
    > 状态栏显示"就绪"并呈绿色。
    
3. 在协作数据列表中，勾选您要包含在基线中的对象；取消勾选您要排除的对象。

4. 点击**发送**。

MCAD Collaborator 生成指定的 PCB 数据。

👀‍**结果**

基线请求文件已保存并出现在历史部分。

状态栏显示"基线已发送...准备发送或接收更多变更"并呈绿色。

如果您启用了电子邮件通知，机械设计团队将收到您的基线请求。


## 接收基线请求

如果您从机械设计团队收到基线请求，您必须接受整个基线数据库才能继续进行协作会话。

基线建立 PCB 设计团队和机械设计团队共享的公共数据库，以便两者同步。未来的变更请求将参考基线数据。


> [!warning] 
MCAD Collaborator 监视存储基线文件的共享目录，并在新变更请求文件(基线或提案)放入目录时自动更新文件部分。

🏃‍♂️‍**步骤**

1. 在 MCAD Collaborator 的文件部分，选择基线文件。

   协作数据部分显示基线文件中包含的设计对象列表。

2. (可选)要获取设计对象的详细信息，请选择它并在属性部分查看该对象的属性。

3. 点击**应用**。


> [!warning] 
如果基线有 `DRC` 错误，将出现警告消息。您可以继续并应用部分成功的项目，而不是使整个事务失败。如果继续，MCAD 和 ECAD 基线文件将不同步。

👀‍**结果**

您的设计数据库将更新基线文件中包含的所有变更。错误消息和处理报告出现在消息窗口中。

基线文件移至历史部分。

状态栏显示："基线已应用。准备发送或接收更多变更"并呈绿色。


## 创建并发送变更请求

您可以对设计中的布局和对象进行更改，然后向机械设计团队发送描述提议变更的变更请求。

**前提条件**

- 已交换并接受基线文件。

🏃‍♂️‍**步骤**

1. 在 MCAD Collaborator 中，从提案类型下拉列表中选择提案。

2. 点击**更新树数据**。


   > [!warning] 每当您在 PCB 设计中做出更改时，**更新树数据**按钮将变为黄色，表示 MCAD Collaborator 中的数据不同步，需要更新。

   MCAD Collaborator 生成您所做的任何更改的修订 PCB 数据，并在协作数据列表中显示更改。

   属性部分显示文件类型为"提案"，状态为"待发送"，文件名为"proposal_nn"。

3. (可选)执行以下操作以将协作数据列表限制为您想要显示的特定对象类型：

    a. 点击**过滤对象**打开对象过滤器对话框。

    b. 在协作对象过滤器列表中，仅勾选您想要在协作数据列表中显示的对象类型，然后点击**确定**。

    **更新树数据**按钮变为黄色，表示列表需要更新。

    c. 点击**更新树数据**以更新协作数据列表并仅显示您在协作对象过滤器列表中选择的对象类型。

4. 在协作数据列表中，勾选您要包含在提案中的对象；取消勾选您要排除的对象。

5. 点击**发送**。


> [!tip] 如果您想在发送后放弃提案，请点击**放弃**。这将取消提案文件并将其在历史部分的状态更改为"已放弃"。

👀‍**结果**

提案文件提交给机械设计团队以供批准或拒绝。错误消息和处理报告出现在消息窗口中。

提案文件出现在历史部分。

状态栏显示："提案已发送。等待响应"并呈黄色。

您可以继续做出其他设计更改或处理机械设计团队发送给您的其他变更请求。(在处理以前的提案和机械设计团队收到的任何响应之前，您不能发送新提案。)

## 审核并应用变更请求

收到机械设计团队的变更请求(提案)后，预览提议的变更并决定是否接受或拒绝它们。

3D 视图通过突出显示提议的变更来显示已添加、修改或删除的内容。

**前提条件**

- 已交换并接受基线文件。

🏃‍♂️‍**步骤**

1. 在 MCAD Collaborator 的文件部分，选择您要预览和验证的提案文件。

   协作数据部分显示提案中包含的设计对象列表。

2. 点击**高亮/取消高亮**以激活高亮显示并启用所选更改的动画。

3. 在协作数据列表中，选择您要预览的对象。

   3D 视图显示您选择的更改的动画回放。

   > [!tip] 有关所选对象的更多详细信息，请在属性部分查看该对象的属性。这将显示对象所做更改的"从"/"到"比较。

4. 根据您在 3D 视图中看到的内容，确定预览的更改是否可以接受。

    | 如果您想要    | 执行以下操作         |
    |---------------|----------------------|
    | 接受变更      | 勾选变更项。         |
    | 拒绝变更      | 取消勾选变更项。     |

5. 对协作数据列表中的每个对象重复步骤 3-4。

6. 点击应用。

    您的设计数据库将更新，您勾选的项将在设计中更改。

    > [!warning] 如果变更创建了 `DRC` 错误，您将收到通知并且变更不会被应用。例如，变更将创建"无法解决的金属错误"。在这种情况下，您需要发送"拒绝"响应。

    提案文件移至历史部分。

    状态栏显示："提案已应用。准备发送响应"并呈绿色。

7. (可选)根据需要重复步骤 3，以查看已做的更改并验证设计是否正确更新。

8. 点击**发送**。

    发送一个*response_nn.idx*文件。

👀‍**结果**

如果您通过电子邮件通知进行协作，机械设计团队将收到您已处理提案的响应。电子邮件包含一个文件(*response_nn.idx*)，机械团队将其加载到他们的设计环境中以查看更改。

状态栏显示："事务完成。准备发送或接收更多变更"并呈绿色。


## 控制不同状态的显示

根据提案中变更项的状态显示不同的变更项，以快速确定要接受的项。

您可以根据提案中的状态控制哪些对象出现在 MCAD Collaborator 的协作数据列表中。您还可以在 SailWind 3D 窗口中高亮显示所选对象以定位并分析其影响。

例如，您可以选择仅查看变更请求中添加的对象，而不查看已删除或更改的对象。这有助于您通过一次只关注一种状态来更有效地评估提议的变更请求。

🏃‍♂️‍**步骤**

1. 在 MCAD Collaborator 的文件部分，选择您要查看的提案文件。

   协作数据部分显示提案文件中包含的对象列表。
   
   > [!tip] 您可以通过以下方式管理文件部分中的文件：
   
   - 选择一个文件并从弹出菜单中选择**清除**以将其从文件列表中删除。
   - 从弹出菜单中选择**全部清除**以删除文件列表中的所有文件。
   - 从弹出菜单中选择**刷新**以更新文件列表。

2. 在显示工具栏中，点击适当的按钮以切换协作数据列表中对象的显示：

    | 如果您想要                                             | 执行以下操作 |
    |--------------------------------------------------------|--------------|
    | 显示(或隐藏)所有已添加的对象。                         | 点击         |
    | 显示(或隐藏)所有已删除的对象。                         | 点击         |
    | 显示(或隐藏)所有已修改的对象。                         | 点击         |

3. (可选)点击，然后在协作数据列表中选择您要在 3D 视图中预览的对象。

所选对象在 3D 视图中高亮显示，以帮助您更快地在设计中定位它。


## 查看变更历史

您可以查看当前协作会话的变更请求历史记录，并查看以前的提案以回忆已做的更改。

🏃‍♂️‍**步骤**

1. 在 MCAD Collaborator 的历史部分，选择您要查看的提案。

   协作数据部分更新以显示所选提案中包含的对象列表。

2. 在协作数据列表中，选择您要查看的对象。

   3D 视图显示您选择的更改的动画回放。

3. 根据需要继续查看提案中的其他单个变更项，或选择不同的提案并查看这些更改。

4. (可选)点击历史部分中的**清除**以清除整个变更历史记录并重置当前协作会话。

变更请求文件移至文件部分，历史部分变为空。协作状态被清除，就像没有发生数据交换一样。


> [!danger] 您无法撤消此操作。

## 管理变更文件

您可以管理文件列表，以便更有效地处理大量基线和变更请求文件。

🏃‍♂️‍**步骤**

1. 在 MCAD Collaborator 的文件区域，选择一个文件。

   > [!tip] 要确保文件区域是最新的，请从弹出菜单中选择**刷新**。

2. 执行以下任一操作：

    | 如果您想要           | 从弹出菜单中选择以下选项 |
    |----------------------|--------------------------|
    | 删除单个文件。       | 清除                     |
    | 删除所有文件。       | 全部清除                 |