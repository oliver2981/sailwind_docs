# 第 38 章 报告功能

您可以为当前加载的设计生成报告。系统提供多种报告格式，您还可以创建符合现有设计标准的报告。每次报告运行会生成名为 report.rep 的文件，存储在*\SailWind Projects*文件夹中。

## 报告类型

运行报告 使用装配变量运行报告 添加或删除报告格式 使用报告向导创建自定义报告

**报告类型**

`SailWind Layout` 包含两种报告类型：预定义报告和可定制报告。预定义报告提供设计的有用统计信息。可定制报告允许您创建和配置包含特定设计信息的报告，用于检查和测试设计。

- 预定义报告

- 可定制报告

**预定义报告**

下表列出了不可删除的预定义报告类型。

| 报告类型 | 描述 |
|------------|---------------------------------------------------------------------------------------------------------------------------------|
| 未使用管脚 | 提供设计中每个封装未使用管脚的列表 |
| 统计信息 | 提供设计的各种统计信息，如层数、钻孔位置和布线连接数 |
| 限制 | 根据程序包限制提供各种设计项目的最大数量 |

**表 123. 预定义报告**

**可定制报告**

`SailWind Layout` 包含可定制的报告格式文件，您可以根据特定输出需求进行调整。这些文件位于*C:\<安装目录>\<版本>\Settings*中，使用报告生成语言(RGL)创建。这些文件的扩展名为*.fmt*。

为帮助您选择合适的报告，报告文件在报告对话框中按输出描述而非文件名列出。表 124 列出了格式、文件名及其描述。

| 报告 | 格式文件 |
|-------------------------|---------------|
| 不含管脚信息的网络表 | netlist.fmt |
| 含管脚信息的网络表 | netlistp.fmt |
| 元件列表 1 | parts1.fmt |
| 元件列表 2 | parts2.fmt |
| 测试点报告 | testpnts.fmt |
| 跳线列表 | jumpers.fmt |
| SailWind 格式网络表 | padsnet.fmt |
| PADS 格式网络表 | padsnetV2.fmt |
| DFT 扩展测试点 | testpoint.fmt |

**表 124. 可定制报告**

**跳线列表报告**

您可以创建列出所有跳线及其特性的跳线列表报告。表 125 显示了一个示例报告文件。

跳线列表报告 -- a b c d e f g h i j.pcb

总计 = 3 条跳线

| 参考编号 | 角度 | 长度 | X1 | Y1 | X2 | Y2 | 信号 |
|--------|-----------|--------|------|------|------|------|--------|
| JMP1 | 90.000000 | 350 | 1825 | 3200 | 1825 | 3550 | GND |
| JMP2 | 0.000000 | 250 | 2600 | 3275 | 2850 | 3275 | GND |
| JMP3 | 90.000000 | 525 | 2725 | 2400 | 2725 | 2925 | DA01 |

**运行报告**

您可以选择运行 12 种预配置报告中的任意一种。其中两种报告生成旧格式的网络表。

🏃‍♂️‍**步骤**

1. 点击**主页>报告**菜单项打开报告对话框。

2. 在"选择输出报告文件"列表中，选择一个或多个报告格式。

   如果所需的报告格式不可用，您可以创建自定义格式，参见"添加或删除报告格式"或"使用报告向导创建自定义报告"。

3. 点击**确定**。

👀‍**结果**

报告将写入*C:\SailWind Projects\report.rep*并在默认文本编辑器中显示。如果选择了多个报告格式，*report.rep*将包含所有报告。

**使用装配变量运行报告**

如果设计使用装配变量，您可以基于装配变量而非基础设计创建报告。

🏃‍♂️‍**步骤**

1. 点击**主页>报告**菜单项打开报告对话框。

2. 在"选择输出报告文件"列表中，选择一个或多个报告格式。

3. 选中"使用装配变量"复选框，然后从名称列表中选择一个变量。

   未安装的元件列为<<未安装>>，替换元件列有正确的元件类型。某些数据可能不反映替换元件的数据，例如，"未使用管脚"报告反映默认元件类型的门分配，但不反映替换元件的门分配。如果清除"使用装配选项"复选框，则报告原始数据库数据。

4. 点击**确定**。

👀‍**结果**

报告将写入*C:\SailWind Projects\report.rep*并在默认文本编辑器中显示。如果选择了多个报告格式，*report.rep*将包含所有选定的报告。

**添加或删除报告格式**

您可以在报告对话框中添加或删除报告格式。如果要添加报告格式，首先需要使用报告生成语言创建格式文件。

更多信息，请参见可定制报告。

🏃‍♂️‍**步骤**

1. 点击**主页>报告**菜单项打开报告对话框。

2. 修改报告格式列表：

    - 向列表添加自定义报告格式，或导入报告格式文件：

      i. 点击**添加**。

      ii. 在报告格式文件对话框中，浏览到格式文件并点击**打开**。格式将添加到列表中并复制到*C:\<安装目录>\<版本>\Settings*文件夹。

    - 从列表中删除报告格式：

      i. 选择格式。

      ii. 点击**删除**。您不能删除"未使用管脚"、"统计信息"和"限制"报告类型。格式将从列表中删除，文件扩展名从 *.fmt* 改为 *.del*。

3. 点击**确定**。


**使用报告向导创建自定义报告**

在最多 8 个步骤中，脚本向导会提示您选择信息，完成后将创建可重用的报告格式脚本，对当前设计运行脚本，并以纯文本、RTF、Excel 和 HTML 格式生成报告。这种方法比手动为报告对话框编写报告生成语言格式更简单。

🏃‍♂️‍**步骤**

1. 点击**工具>基础脚本>基础脚本**菜单项。

2. 在基础脚本对话框中，滚动脚本列表并选择 `SailWind Layout` 脚本向导。

3. 点击**运行**。

4. 按照向导屏幕操作，在最后屏幕上，点击"完成"创建报告脚本，或点击"完成并立即运行报告"也可查看报告。

生成报告的基础脚本将出现在基础脚本对话框中供重用，报告将以所选格式打开。如果不打算再次使用，可以删除报告的基础脚本。

**示例**

创建并运行一个元件高度报告，列出设计中每个元件的高度。

1. 点击**工具>基础脚本>基础脚本**菜单项。

2. 在基础脚本对话框中，滚动脚本列表并选择 `SailWind Layout` 脚本向导。

3. 点击**运行**。

4. 在介绍屏幕上，点击**下一步**。

5. 在格式屏幕上，点击 Microsoft Excel，然后点击**下一步**。

6. 在报告类型屏幕上，点击 PCB 基础报告，然后点击**下一步**。

7. 在数据库对象屏幕上，点击元件，然后点击**下一步**。

8. 在数据类型屏幕上，点击表格格式的通用元件属性，然后点击**下一步**。

9. 在对象属性屏幕上，在"属性(选择现有或输入任何有效名称)"列表中点击 Geometry.Height，然后点击**添加**。

10. 在报告选项屏幕上，点击**下一步**。

11. 在输出文件屏幕上，在"输入结果 VB 脚本名称(不带 BAS 扩展名)"框中键入报告名称，该名称将显示在基础脚本对话框中。

**12. 点击完成并立即运行报告。**

13. 将为当前设计生成 Excel 报告，报告每个元件的 Geometry.Height 属性值。当需要再次生成报告时，在基础脚本对话框中选择它并点击运行。