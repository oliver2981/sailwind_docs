# 第 4 章 文件操作

使用文件操作创建并保存新的原理图文件。您还可以打开和保存现有设计、导入和导出其他文件格式的文件以及存档原理图。

## 创建新的原理图文件

您可以为您的设计创建一个新的空白原理图文件。SailWind Logic 使用先前定义的默认设置来定义初始设计配置。

**先决条件**

• 使用主页 > 新建菜单项从内存中清除当前原理图并启动新原理图。

**步骤**

1. 在主工具栏上，点击“新建”按钮。系统会提示“重置前是否保存旧文件？”。

2. 如果点击“否”，工作区中将显示一张代表新原理图第 1 页的空白图页。如果点击“是”，且当前原理图未命名，则会出现“保存原理图文件”对话框。

   或者，您也可以从 Microsoft® 文件资源管理器中的弹出菜单中创建新文件。

   a. 在文件资源管理器中，转到要创建文件的文件夹。
   
   b. 右键单击，然后点击“新建 > SailWind Logic Schematic 菜单项。此操作会在当前文件夹中创建一个新的设计文件。

   c. 输入文件名并按 Enter 键。确保文件扩展名为 .sch。这将创建一个零字节文件。
   
   当您在 SailWind Logic 中打开此文件时，SailWind Logic 会识别该零字节文件，并使用 default.txt 执行 File > New 命令。

## 保存原理图文件

使用“主页 > “保存”（或“另存为”）菜单项将设计信息写入文件。“文件另存为”对话框显示默认 \\SailWind Projects 文件夹中包含的原理图文件。显示的文件列表包括在 PowerLogic 和 SailWind Logic 中创建的文件。

限制：其他用户打开的文件将被锁定，无法进行任何编辑。请参阅打开已在使用的文件。

当前打开的设计名称显示在对话框底部的“文件名”文本框中。单击“保存”即可保存文件。如果文件名已存在，则会提示您是否覆盖现有文件。新设计将显示默认文件名。

您还可以通过单击标准工具栏上的“保存”按钮来保存文件。

## 打开原理图文件

您可以用不同的方式打开原理图文件。

**限制和局限性**

其他用户打开的文件将被锁定，无法进行任何编辑。请参阅第 57 页的“打开已在使用的文件”。

**步骤**

1. 在工具栏上，单击“打开”按钮。“文件打开”对话框将显示默认 \\SailWind Projects 文件夹中包含的原理图文件。列表根据“文件类型”设置显示文件。
2. 从“文件类型”下拉列表中选择“原理图文件 (\*.sch)”。
3. 选择一个原理图文件，然后点击“打开”，将设计加载到 SailWind Logic 中。或者，您也可以通过将文件从 Windows 资源管理器拖放到 SailWind Logic 窗口中来打开文件。

## 文件导入和导出

使用 SailWind Logic，您可以导入不同类型的文件，包括使用其他工具创建的原理图数据。您可以从打开的原理图中提取设计信息，并将其保存为与先前或当前软件版本兼容的 ASCII 格式。

### 导入文件类型

SailWind Logic 使您能够导入不同类型的文件，包括各种格式的数据和使用其他工具创建的示意图。

您可以使用导入功能进行以下操作：

- 将各种格式的数据插入当前示意图。

- 转换使用其他工具创建的原理图，并将其作为新的 SailWind Logic 原理图打开。此功能调用符号和原理图转换程序的非 GUI 实例来转换单个设计，使用位于 :

  ```bash
  C:\<install_folder>\<version>\Settings 
  (cadstar2pl.cnv, orcad2pl.cnv, pcad2pl.cnv, and protel2pl.cnv)
  ```

有关更复杂的翻译的信息，例如仅翻译 .DDB 容器中的选定文件，或使用特殊映射进行翻译，请参阅 SailWind 符号和示意图翻译器指南。

表 7. 导入当前原理图的文件类型

| 文件类型 | 描述 |
| --- | --- |
| ASCll 文件格式 (*.txt) | PADS 格式的 ASCll 文件。您可以导入的 ASCll 文件包括 PowerLogic 和 SailWind Logic 创建的 ASCll 文件。注意：从 PADS 9.0 开始，裸片和倒装芯片将通过 |
| 元件类型中的特殊用途设置，而不是由 DiE 和 FLP 逻辑系列指定。导入由旧版 PADS 创建的 ASCll 文件时，这些特殊用途设置将自动为逻辑系列为 DIE 或 FLP 的元件设置。元件的系列名称保持不变。 |  |
| 第 65 页上的 OLE 导入/导出 (*.ole) | SailWind Logic 允许您使用“编辑/插入新对象”将其他应用程序中的文件作为 OLE 对象嵌入到原理图中。一旦您的设计中包含了 OLE 对象，您就可以使用“文件导出”将该对象作为单个项目导出到 .ole 文件（参见导出文件）。然后，您可以将 .o/e 文件导入到其他 SailWind Logic 原理图中。 |
| ECO 文件 (*eco) | 类似于 PADS 格式的 ASCll。每种类型的数据都以标题行开头，标题行中包含一个关键字，关键字周围用星号 (*) 括起来。 |
| （.asc）文件 | SailWind 布局规则。 |
|  |  |

表 8. 作为新原理图打开的文件类型

| 文件类型 | 描述 |
| --- | --- |
| CAD .csa 文件 | CADSTAR 存档文件 (ASCII) |
| CADSTAR .scm 文件 | CADSTAR 原理图文件（二进制） |
| OrCAD .dsn 文件 | OrCAD 捕获文件 |
| P-CAD .sch 文件 | P-CAD 2002 及更新版本生成的 P-CAD 原理图文件（ASCll 和二进制） |
| Protel .sch 文件 | Protel 99 原理图文件（ASCll 和二进制） |
| Protel .schdoc 文件 | Protel DXP/Altium Designer 原理图文件（ASCll 和二进制） |
| Protel .prjpcb 文件 | Protel 组合设计/原理图文件 |

### 导入文件

SailWind Logic 支持将不同类型的文件导入设计环境。

**步骤**

1. 单击主页 > 导入菜单项。
2. 在显示的提示中，单击“是”在导入文件之前保存现有设计，或单击“否”导入文件而不保存更改。
3. 从“文件类型”下拉列表中，选择要导入的文件类型。
4. 选择要导入的文件，然后单击“打开”。状态栏中会报告导入进度，输出窗口中会显示日志消息和日志文件链接。

### 导出文件

从打开的原理图文件中提取设计信息，并将其保存为与先前或当前软件版本兼容的 ASCII 格式。您还可以使用导出功能为 SailWind Logic 创建默认启动条件。

> [!INFO]
>
> 您可以以 ASCII 格式保存全部或部分打开的设计。

**步骤**

1. 单击主页 > 导出菜单项。

2. 从“保存类型”下拉列表中，选择要导出的文件类型。

3. 在“文件名”文本框中输入 ASCII 文件的名称。默认值为当前打开的设计名称。

4. 单击“保存”。

   这将打开“导出为 ASCII 输出”对话框。选中相应的复选框以指示要写入 ASCII 文件的信息。

   > [!INFO]
   >
   > SailWind Logic 允许您通过点击“编辑 > 插入新对象菜单项，将其他应用程序中的文件作为 OLE 对象嵌入到您的设计中。在您的设计中添加 OLE 对象后，您可以将该对象作为单个项目导出到 .ole 文件。

5. 为导出的文件选择 SailWind Logic 输出版本。

   从 PADS 9.0 开始，裸片元件和倒装芯片将通过“元件类型”中的“特殊用途”设置进行识别，而不是通过 DIE 和 FLP 逻辑系列进行指定。进行此更改后，将设计导出到旧版 PADS 的 ASCII 文件时会发生以下变化：

   - 任何芯片元件和倒装芯片的特殊用途设置均被清除。
   - 具有除 DIE 和 FLP 之外的系列名称的裸片元件和倒装芯片将失去其裸片元件或倒装芯片特殊用途，并成为普通元件。
   - 在之前的 PADS 版本中，任何带有 DIE 或 FLP 系列标识的普通元件均被视为裸片元件或倒装芯片。更多信息，请参阅 OLE 对象导入和导出。

### OLE 对象导入和导出

您可以在 SailWind Logic 中导入和导出 .ole 文件，以添加在其他程序中创建的图像、文本文件和其他对象，并将其链接或嵌入到您的设计中。您还可以从 SailWind Logic 导出图像和对象，以便将其包含在文档或报告中。

#### 导入 OLE 文件

您可以将包含 OLE 对象的 .ole 文件导入 SailWind Logic 示意图，也可以将示意图中的 OLE 对象导出到 .ole 文件。

**步骤**

1. 单击主页 > 导入菜单项。
2. 提示时单击“是”保存当前设计更改，或单击“否”放弃它们。
3. 在文件导入对话框中，选择“OLE 文件 (\*.ole)”作为要导入的文件类型。
4. 浏览并选择要打开的文件。
5. 单击“打开”，然后在提示符下单击“是”。
OLE 对象导入到当前原理图。

**结果**

OLE 对象会放置在创建它们的图页上。例如，如果您最初将一个 OLE 对象放置在图页 1 上，将另一个对象放置在图页 2 上，则导入后，这两个 OLE 对象会分别放置在图页 1 和图页 2 上。

如果您要导入的某些 OLE 对象位于当前原理图中不存在的图页上，则这些对象将被删除。例如，您最初在图页 1、2 和 3 上创建了 OLE 对象。要导入 OLE 对象的原理图仅包含图页 1 和 2。图页 3 中的 OLE 对象将被删除。

#### 导出 OLE 文件

您可以从 SailWind Logic 导出 OLE 对象，以便其他程序或其他 SailWind Logic 设计会话可以使用它们。

> [!TIP]
>
> 当选择对象时，对象周围会出现控制柄。

**步骤**

1. 选择一个 OLE 对象，然后单击主页 > 导出菜单项。

2. 在文件导出对话框中，选择 OLE (\*.ole) 作为文件类型。

3. 命名文件并选择保存文件的位置。

4. 点击“保存”。.ole 文件已创建，可导入到其他 SailWind Logic 原理图。

   > [!TIP]
   >
   > 您还可以使用“编辑 > 插入新对象菜单项从其他来源导入应用程序文件。您无法导入 .ole 文件。

### ASCII 文件格式

您可以将 SailWind 设计文件导出为 ASCII 文件格式，以便在 SailWind 设计环境之外编辑信息。SailWind Logic 的 ASCII 文件按部分组织，以星号括起来的关键字开头。

第一部分以 SCH 开头，给出电路的系统设置参数。

第二部分以 CAM 开头，列出了绘图和打印输出的默认设置

随后，每个图页的所有数据都会分组到 SHT 部分中。这些数据以 CAE 开头，列出了图页的窗口缩放设置和光标位置。

表 9. ASCII 文件格式部分

| 选项 | 描述 |
| --- | --- |
| TXT | 图页中的自由文本项目。 |
| LINES | 2D 线项目，包括库条目。 |
| CAEDECAL | 图页中所有元件的 CAE 符号封装的描述。 |
| PARTTYPE | 图页中出现的元件类型的描述。 |
| BUSSES | 表格中Bus的描述，包括名称和位置。 |
| PART | 列出图页中出现的所有元件及其属性。门和​​连接器管脚均单独列出。 |
| OFFPAGE REFS | 列出图页中所有页外标记。其中包括电源和接地符号以及总线连接。 |
| TIE-DOTS | 图页中所有连接点的列表。 |
| CONNECTION | 图页中的连接列表，包括信号名称和路径。 |
| NETNAMES | 原理图中显示的所有网络名称的列表。 |

列出所有图页后，文件以 \*END\* 结尾。

### 导出至 ASCII 输出

定义要写入 ASCII 文件的信息。

**步骤**

1. 单击主页 > 导出菜单项。

2. 键入输出文件的名称，然后单击“保存”。

   >[!TIP]
   >文件名和路径出现在 ASCII 输出对话框的底部。

3. 在 ASCII 输出对话框中，选择“选择要输出的部分”区域中要出现在 ASCII 文件中的项目。

   您可以单击“全选”以选择所有项目，或单击“取消全选”以清除所有选择。

4. 在 SailWind Logic 输出版本区域，从列表中选择您正在使用的软件的适当版本。

5. 单击“确定”。

## 归档您的原理图

您可以创建一个文件夹、一个 PDF 或一个 .zip 文件，其中包含所有原理图文件和支持文件。这包括原理图本身、设计文件、库以及您需要的任何其他文件或文件夹。您可以选择要存档的内容；所有字段均为可选。

**步骤**

1. 打开您想要存档的原理图。
2. 单击主页 > 存档菜单项。
3. 在存档器对话框中选择要存档的文件和文件夹。
4. 单击“确定”。

**结果**

将创建一个存档文件夹，其中包含设计和/或原理图文件、库以及您指定的任何其他文件和文件夹。

如果您选择压缩文件，则 .zip 文件是此文件夹中的唯一文件。

如果您选择创建 PDF，则使用原理图名称创建文件并将其放置在存档文件夹中。

如果您选择使用 zip 格式压缩文件，则会创建以下格式的 .zip 文件：

```bash
<project_name>YYYYMMDDHHMMSS.zip
```

其中 YYYY 代表年份，MM 代表月份，DD 代表日期，HH 代表小时（采用 24 小时制），MM 代表分钟，SS 代表文件创建时间的秒数。该文件包含与存档文件夹相同的文件夹结构。

