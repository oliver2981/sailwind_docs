# 第 3 章 用户界面

该软件界面强大且可配置。它提供了多种查看和导航设计的方法，以及丰富的自定义宏脚本生成功能，可用于回放和调试。

## 视图控制

您可以使用多种方法来控制数据库的哪部分在屏幕上可见。

### 查看命令和滚动条

您可以通过多种不同的方式与设计环境交互来控制设计视图。SailWind Logic 提供了一套全面的命令，让您能够在设计中平移和缩放，包括使用鼠标按钮/滚轮、键盘快捷键以及“视图”菜单上的各种选项。

要控制视图，请使用滚动条或“视图”菜单中的以下命令：

- 单击视图 > 缩放菜单项或工具栏上的缩放按钮进入缩放模式。
  - 要放大，请将光标放在所需的视图中心，然后单击鼠标左键。
  - 要缩小，请将光标放在所需的视图中心，然后单击鼠标右键。
  - 要定义特定的视图区域，请将光标放在所需的视图中心，单击并拖动以定义范围，然后释放。
- 单击视图 > 重画菜单项或工具栏上的刷新按钮以重画当前视图。
- 单击“查看 > 图页菜单项，或单击工具栏上的“图页”按钮以显示整个图页。
- 单击视图 > 范围菜单项来调整视图大小以显示设计中的所有对象。
- 使用滚动条平移视图。

### 鼠标中键

您可以使用鼠标中键执行多项查看操作。

使用鼠标中键执行平移和缩放操作：

- 要平移，请点击鼠标中键。视图以光标为中心。
- 要放大，请点击并按住鼠标中键。沿对角线向上拖动光标。要调整边界框，请移动鼠标。松开鼠标中键后，边界框内的区域将显示出来。
- 要缩小，请点击并按住鼠标中键。沿对角线向下拖动光标。这将绘制一个内框，代表当前视图。移动光标可以调整外框，代表新视图。外框相对于内框的相对大小决定了视图缩小的程度。松开鼠标中键即可完成缩小操作。
- 要查看整个设计，请单击并按住鼠标中键，水平拖动光标，然后松开。

### 数字键盘 ಠ_ಠ

使用数字键盘来控制视图。

有关详细信息，请参阅使用数字键盘控制视图。

### 保存和恢复视图

如果您反复平移或缩放到设计的特定区域，则可以通过保存工作区域视图来节省时间，以便在需要时立即恢复它。

> [!WARNING]
>
> 在元件编辑器中无法进行捕获。

#### 保存视图

您可以保存设计视图以供日后调用。

🏃‍♂️‍**步骤**

1. 安排工作区域以显示您想要捕获的视图。
2. 单击**查看** > 保存视图菜单项。

   > [!TIP]
   >
   > 在“保存视图”对话框中，预览显示所选视图相对于设计范围的位置。

3. 在“保存视图”对话框中，单击“捕获”。
4. 在“捕获新视图”对话框中，输入视图的新名称，然后单击“确定”。新视图名称会列在“视图名称”列表中。

   > [!TIP]
   >
   > 您最多可以创建九个视图。视图名称显示在“视图”菜单的底部。

5. 单击“关闭”。

#### 恢复视图

您可以恢复以前保存的视图。

🏃‍♂️‍**步骤**

1. 单击**查看** > 保存视图菜单项。
2. 从视图名称列表中选择一个名称，然后单击应用以将先前选择的视图应用到工作区。

  > [!TIP]
  >
  > 应用视图时，上一个视图会自动保存。点击“视图 > “ 上一个视图”菜单项即可恢复该视图。
3. 从视图名称列表中选择一个名称，然后单击删除将其从视图名称列表中删除。

## 项目浏览器

项目资源管理器以层次结构列出设计中的对象。更新设计时，层次结构也会自动更新。

>  [!WARNING]
>
> 项目资源管理器在元件编辑器中不可用。

>  [!INFO]
>
> 要打开项目资源管理器，请单击项目资源管理器按钮。

您可以配置项目资源管理器，以便您可以单击列出的对象在工作区中选择它，或者选择它并放大到它。

🏃‍♂️‍**步骤**

1. 在项目资源管理器中**右键**单击，然后单击“允许选择”菜单项。

   复选标记表示该功能已启用。

2. 如果要缩放至所选对象，请点击“缩放至所选内容”菜单项。

   复选标记表示该功能已启用。

## 输出窗口

使用输出窗口查看报告和会话日志、宏编辑和调试以及自定义编程和调试。

输出窗口位于显示窗口的左下方。您可以停靠或浮动输出窗口。您还可以打开或关闭输出窗口。

输出窗口有两个选项卡：

- 状态选项卡— 显示有关当前会话的信息。
- 宏选项卡 — 使您能够运行、编辑和调试脚本。

### 会话日志管理

可以使用多种方法来管理会话日志，包括过滤、查看、打印和保存日志数据。

#### 会话日志 ಠ_ಠ

会话日志出现在“输出”窗口的“状态”选项卡中，包含当前会话的所有程序输出，包括打开和保存的文件的名称、完整性测试结果。

“状态”选项卡中的会话日志文件消息按主题采用颜色编码。带下划线的项目表示链接。颜色代码如下表所示：

表 3. 会话日志文本颜色含义

| 颜色 | 意义 |
| --- | --- |
| 红色的 | 错误 |
| 绿色的 | 警告 |
| 黑色的 | 消息 |
| 蓝色的 | 指向文件、网页和数据库对象的链接 |

:::details{title=在状态选项卡中导航页面，无此功能}

#### 在状态选项卡中导航页面

使用“输出”窗口中的“状态”选项卡工具栏按钮导航到上一页或下一页，并刷新报告和其他页面的显示。您还可以停止页面更新并返回到会话日志显示。

要执行这些功能，请使用以下“状态”选项卡工具栏按钮：

表 4. 状态选项卡工具栏按钮

| 命令 | 描述 |
| --- | --- |
| 后退 | 显示上一页。 |
| 向前 | 显示下一页。 |

表 4. 状态选项卡工具栏按钮（续）

| 命令 | 描述 |
| --- | --- |
| 停止 | 停止页面更新。 |
| 刷新 | 刷新报告和其他页面的显示。 |
| 家 | 返回会话日志。 |

:::

:::details{title=过滤状态选项卡显示，无此功能}

#### 过滤状态选项卡显示

“状态”选项卡中的会话日志文件消息按主题以颜色编码。您可以选择查看任意颜色编码消息的组合。

使用以下步骤过滤“状态”选项卡中的显示。

🏃‍♂️‍**步骤**

1. 在“输出”窗口中单击鼠标右键，然后从“筛选条件”弹出菜单项中单击以下命令之一：

表 5. 筛选条件子菜单命令

| 命令 | 描述 |
| --- | --- |
| 错误 | 显示错误。 |
| 警告 | 显示警告。 |
| 信息 | 显示消息。 |
| 全部显示 | 显示所有项目（错误、警告和消息）。 |

1. 选择一个项目来显示它；清除该项目来隐藏它。

:::

:::details{title=在控制台选项卡中搜索，无此功能}

#### 在控制台选项卡中搜索

如果您想在日志中查找特定项目或术语，您可以在“控制台”选项卡中搜索文本。您可以选择全词搜索或特定大小写匹配搜索。

🏃‍♂️‍**步骤**

1. **右键**单击并单击“查找”弹出菜单项。
2. 在“查找”对话框中，键入要在对话框中查找的文本并完成任何其他对话框选项。
3. 点击“下一步”。标签页会滚动到该单词出现的位置，并高亮显示该单词。

:::

:::details{title=打印会话日志消息，无此功能}

#### 打印会话日志消息

您可以打印会话日志的硬拷贝以供审查。

🏃‍♂️‍**步骤**

1. **右键**单击并单击“打印”。
2. 在 Windows 标准打印对话框中，根据需要设置选项。
3. 单击“打印”。

:::

:::details{title=查看和打印报告，无此功能}

#### 查看和打印报告

会话日志包含您可以查看和打印的报告链接。

要查看报告，请点击链接。报告将替换会话日志，成为“状态”选项卡中的活动页面。

您可以打印显示的报告。

🏃‍♂️‍**步骤**

1. **右键**单击显示的报告，然后单击“打印”。

   > [!TIP]
   >  或者，在“状态”选项卡工具栏上，单击“打印”按钮。

2. 在 Windows 标准打印对话框中根据需要更改任何打印对话框选项。
3. 单击“打印”。

:::

:::details{title=将会话日志保存到文件，无此功能}

#### 将会话日志保存到文件

有时您可能想要参考会话日志中记录的内容（例如，调试文件或提交支持中心请求时）。您可以将会话日志保存到文件中以供将来参考。

🏃‍♂️‍**步骤**

在状态工具栏上，单击“记录到文件”按钮以保存会话日志以供将来参考。

如果会话日志文件已存在，则附加新信息。如果会话日志文件不存在，则创建新文件。

会话日志的默认路径来自.ini 文件条目：

```bash
FileDir=C:\SailWind Projects
```

首次启动该软件时，位置设置在以下注册表项中：

```bash
HKEY\_CURRENT\_USER\\Software\\Mentor Graphics<version>\\SailWind Layout\\Status Window\\LastLogName
```

:::

:::details{title=清除会话日志显示，无此功能}

#### 清除会话日志显示

当不再需要会话日志时，您可以清除它。

🏃‍♂️‍**步骤**

**右键**单击并单击“清除”可在每次打开文件时清除会话日志显示。

👀‍**结果**

这会阻止您查看先前打开的文件中的信息。它不会删除日志文件。

:::

### 宏

您可以创建宏来简化冗余活动。您可以录制任意一组程序步骤，并将其作为单个操作进行重放。您还可以嵌套宏。

> [!TIP]
对话框操作会被记录为结果而非操作，因此在回放时，您不会在回放过程中看到对话框。因此，您无法创建在打开对话框时停止的宏；它必须遵循某些结果或操作。例如，您可以创建一个宏，选择“主页 > “ 打开”菜单项，选择一个文件，然后选择“确定”。该宏在回放时会打开一个文件。

#### 创建新宏

宏非常灵活，即使在当前设计会话之外也能提供实用功能。您可以记录按键、鼠标移动和命令，然后将其保存以供日后调用，从而创建新的宏。

🏃‍♂️‍**步骤**

1. 在主工具栏上，单击“输出窗口”按钮。
2. 在“宏”选项卡上，单击“新建”按钮。新建的宏将被命名为“宏#”，其中“#”是数字序列，例如“宏 1”或“宏 2”。
3. 如果需要，请点击**“压缩鼠标移动”和/或“相对鼠标移动”**按钮。有关更多信息，请参阅“记录鼠标移动”。
4. 在“宏”选项卡工具栏上，单击“录制”按钮。
5. 执行要包含在宏中的击键、命令和鼠标单击。
6. 在“宏”选项卡工具栏上，单击“停止”按钮。或者，您也可以编写宏脚本，而不是录制鼠标操作。

#### 记录鼠标移动

鼠标移动会被记录在宏中。您可以记录压缩或非压缩的鼠标移动，以及相对或绝对的移动。

- 压缩鼠标模式 — 压缩鼠标模式仅记录鼠标移动的起点和终点。它不记录起点和终点之间的任何中间坐标。大多数情况下建议使用压缩模式，因为它可以显著减小宏文件的大小。记录中间鼠标移动会增加文件大小，但如果特殊应用程序需要，它会记录坐标信息。


- 相对鼠标模式——相对鼠标模式以增量坐标而不是绝对坐标记录移动的起点和终点。


#### 打开现有的宏文件

宏是在扩展名为 .mcr 的宏文件中创建和存储的。要打开现有的宏文件 (.mcr)，您可以使用菜单或工具栏。

您可以在宏编辑器中打开多个宏。宏编辑器还支持嵌套宏。

🏃‍♂️‍**步骤**

1. 在主工具栏上，单击“输出窗口”按钮；然后在“输出”窗口中，单击“宏”选项卡。
2. 单击“打开”按钮，或者在“打开文件”对话框中选择宏文件，然后单击“打开”。

#### 查看多个打开的宏

您可以在多个打开的宏之间切换视图。这样，您就可以在多个宏之间来回切换，而无需逐个打开和关闭它们。

🏃‍♂️‍**步骤**

单击“宏”选项卡的“打开的宏列表”区域（左侧窗格）中的宏可在打开的宏之间切换。

#### 编辑宏

您可以将选定的文本复制或剪切到剪贴板。您还可以将剪贴板中的选定内容粘贴到文本窗口。您可以将剪贴板中的文本粘贴到其他应用程序中。您还可以在打开的宏之间切换以编辑多个宏。

> [!danger] 
如果您将记事本作为默认文本编辑器，则由于记事本的大小限制，较长的宏文件可能无法加载。有关如何更改默认文本编辑器的信息，请参阅更改默认文本编辑器。

🏃‍♂️‍**步骤**

1. 选择要复制或剪切的文本。
2. 在“宏”选项卡工具栏上，单击“复制”或“剪切”按钮。
3. 将指针放在要放置复制文本的插入点处。
4. 在“宏”选项卡工具栏上，单击“粘贴”按钮。

   您将看到您的选择已粘贴到插入点的输出窗口。

   或者，**右键**单击“输出”窗口，然后单击“复制”、“剪切”或“粘贴”。

#### 更改默认文本编辑器

要使用编辑访问大文件，您必须安装具有合适文件大小容量的 ASCII 文本编辑器。

🏃‍♂️‍**步骤**

1. 在文本编辑器中打开 SailWindlogic.ini 文件。
2. 修改 \[general\] 部分，指定新的文本编辑器可执行文件名称。如果新编辑器不在 Windows 文件夹中，请包含驱动器和文件夹。
3. 保存.ini 文件并关闭文本编辑器。

#### 保存宏

宏不仅限于当前设计会话。您可以保存宏以供将来调用。

🏃‍♂️‍**步骤**

1. 单击“保存”按钮。
2. 在标准 Windows“另存为”对话框中，输入文件名（如果需要），然后单击“保存”。


### 宏播放

您可以使用“运行”来播放现有宏。“运行”还可以恢复暂停的宏的播放。
播放宏时，您无法在工作区中使用鼠标。

#### 播放宏

一旦记录了宏，您就可以播放它。

🏃‍♂️‍**步骤**

1. 在“宏”选项卡上，单击“打开”按钮并打开一个宏 (.mcr) 文件。
   您可以通过单击“工具”>“宏”菜单项，然后从列表中选择所需的宏来查找最近的宏。
2. 在“宏”选项卡的工具栏上，单击“运行”按钮。
或者，**右键**单击“宏”选项卡，然后单击“运行”。

#### 暂停正在播放的宏

您可以在播放期间暂停宏。

🏃‍♂️‍**步骤**

1. 在“宏”选项卡工具栏上，单击“暂停”按钮可随时暂停正在播放的宏。
2. 单击“播放”按钮继续播放宏。

#### 停止正在播放的宏

您可以停止当前正在播放的宏。

🏃‍♂️‍**步骤**

在“宏”选项卡上单击鼠标右键，然后单击“停止”，或者在“宏”选项卡工具栏上单击“停止”按钮以停止播放宏。

宏一旦停止，就无法恢复播放。单击“运行”后，宏将从头开始播放。


### 宏脚本调试 ಠ_ಠ

播放宏时，您可以逐步运行，也可以运行到脚本中的某个位置。要执行这些调试任务，请在宏中您希望宏停止的位置插入断点

#### 设置或删除断点

在调试宏时，设置或移除断点的功能非常有用。如果宏引擎在播放宏时遇到断点，它会暂停该宏。

🏃‍♂️‍**步骤**

1. 将光标放在要添加断点的行上。

2. 在“宏”选项卡中**右键**单击，然后单击“切换断点”，或者在“宏”选项卡工具栏上单击“切换断点”按钮。

   这将在当前光标位置插入一个断点。断点标记将显示在装订线区域。

   当宏引擎在播放宏时遇到断点时，它会暂停宏。宏中的下一行将用指令指针进行标记。

#### 调试宏脚本

一旦插入断点，您就可以调试宏。

##### 播放一行宏

您可以使用“宏”选项卡工具栏上的按钮或鼠标右键菜单命令来播放单行宏。

🏃‍♂️‍**步骤**

在“宏”选项卡中单击鼠标右键，然后单击“步过”菜单项，或在“宏”选项卡工具栏上单击“步过”按钮

##### 在当前行执行子程序调用

您可以使用“宏”选项卡工具栏上的按钮或鼠标右键菜单命令在当前行执行子程序调用。

🏃‍♂️‍**步骤**

在“宏”选项卡中单击鼠标右键，然后单击“步入”菜单项，或者在“宏”选项卡工具栏上单击“步入”按钮。

##### 将宏播放至某个点

您可以使用“宏”选项卡工具栏上的按钮或鼠标右键菜单命令将宏播放到某个点。

🏃‍♂️‍**步骤**

在“宏”选项卡中单击鼠标右键，然后单击“步进到光标”菜单项，或者单击“宏”选项卡工具栏上的“步进到光标”按钮。

##### 从子程序返回到调用它的位置

您可以使用“宏”选项卡工具栏上的按钮或鼠标右键菜单命令从子程序返回到调用该子程序的点。

🏃‍♂️‍**步骤**

在“宏”选项卡中单击鼠标右键，然后单击“跳出”菜单项，或者在“宏”选项卡工具栏上单击“跳出”按钮。

##### 从当前点继续执行

您可以使用“宏”选项卡工具栏上的按钮或鼠标右键菜单命令从当前点继续执行宏。

🏃‍♂️‍**步骤**

在“宏”选项卡中单击鼠标右键，然后单击“运行”菜单项，或者在“宏”选项卡工具栏上单击“运行”按钮。

#### 运行时错误纠正 ಠ_ಠ

如果发生运行时错误，宏调试器将切换到逐步模式，并在状态栏上显示详细信息。指令指针将指向产生错误的行。修复错误后，您可以继续播放宏。


### 访问宏语言帮助

您可以随时访问有关宏语言的帮助。

🏃‍♂️‍**步骤**

单击“宏”选项卡的编辑区域并按 F1 获取有关该术语和示例脚本的信息。

### CIS 🚧

:::danger{title=问题说明}

输出窗口没有 CIS Tab

待产品确认

:::

CIS 选项卡会显示来自 CIS 的元件信息（如图所示）。您可以：

1. 指定要使用的数据源的新配置并选择在 CIS 选项卡中显示的内容。
2. 从 CIS 搜索并添加元件。
3. 将设计中的元件属性与 CIS 中的元件属性进行比较，以检查一致性。


#### 添加新配置

启动后，SailWind Logic 会自动连接到指定的数据源，并从中将数据加载到 CIS 选项卡中。

按照以下步骤指定新配置并选择在 CIS 选项卡中显示的内容。

🏃‍♂️‍**步骤**

1. 在 CIS 选项卡工具栏上，单击新建按钮。

2. 在库配置对话框中，按如下方式添加并连接到目标数据源：

   a. 单击 ODBC 配置。

   b. 在弹出窗口中添加要使用的 ODBC 数据源。

   c. 单击更新以使新添加的数据源处于活动状态并在 ODBC DSN 列表中可用。

   d. 从列表中选择目标数据库以建立连接并在数据库表区域中加载其表列表。

3. 通过选中“到 CIS”复选框来选择要使用的数据库表。

   只有选定的内容才会在 CIS 选项卡中可用。

4. 在“表格配置”区域中，指定 CIS 选项卡中显示的表格字段内容及其显示方式。有关更多信息，请参阅下表。

   表 6. 表格配置说明

   | 名称 | 描述 |
   | --- | --- |
   | 字段名称 | 列出左侧选定表中的所有字段。 |
   | 字段类型 | 从下拉列表中指定表字段所属的类型，其中：· Part_Type 为必填项，用于将数据加载到 CIS 选项卡中。此外，您还可以在 CIS 预览窗口中查看本地库中分配给该元件类型的原理图符号和 PCB 封装。· Part_Number 为必填项，用于检查设计中的元件属性值是否与 CIS 中的一致。· Category 允许在 CiS 选项卡中按子类别分层显示表格结构。· 除“常规”字段外，所有字段类型都必须唯一。 |
   | 字段别名 | 指定在 Cis 选项卡中显示的每个字段的表头。· 字段类型“Part_Type”和“Part_Number”对应的字段别名已默认定义，不允许修改。· 如果未设置任何内容，则将使用“字段名称”代替。 |
   | 转移到设计 | 指定将字段名称添加到元件属性中。如果是，您可以在设计中检查元件属性，并在元件属性列表中查看该字段名称。提示 |
   | CIS 中的可见性 | 设置后，将改用“字段别名”。指定在 Cis 选项卡中显示“字段名称”。设置后，将改用“字段别名”。 |
   | 钥匙 | 预订的 |
   | 可浏览 | 指定在 Cis 选项卡中的字段内容中添加超链接，这些超链接通常链接到数据表和图页等参考文件。 |
   | 财产检查 | 指定要在元件管理器对话框中进行比较的属性，检查设计中的属性值是否与 CiS 中的属性值相同。 |

5. 单击“保存”以保存配置。

   SailWind Logic 自动连接到数据源并将指定的信息加载到 CIS 选项卡中。

#### 从 CIS 添加元件

根据需要配置数据源后，您可以在设计中查看和使用 CIS 数据。为了高效地定位元件，SailWind Logic 提供了筛选功能。本节介绍如何使用 CIS 数据。

🏃‍♂️‍**步骤**

1. 连接到目标数据源，并指定要显示的表字段，具体操作请参见“添加新配置”。

2. 2. 在 CIS 选项卡中，在左侧选择一个表，在右侧查看其元件信息。

3. 使用筛选条件查找元件，然后单击“搜索”以激活筛选条件。系统将显示符合搜索筛选条件设置的元件。

   支持按字段名称和关键字进行过滤，但目前不支持通配符或表达式。

4. 选择一个元件并在预览窗口中检查其元件类型（CAE 封装）和 PCB 封装。

5. 向设计中添加一个元件，如下所示：

   a. 双击表格中的目标元件。该元件将附着并跟随光标移动。
   b. 单击原理图以放置元件；另一个实例会自动附加到光标处。
   c. 添加完元件后，按 Esc 键。

6. 在设计中选择元件，**右键**单击，然后点击“属性”弹出菜单项。在属性列表中，您可以看到通过“库配置”对话框中的“传输到设计”功能添加的属性。

#### 比较元件属性以进行一致性检查

使用元件管理器将设计中的元件属性与 CIS 中的属性进行比较，以检查一致性。对于不一致的属性，您可以使用多种选项从 CIS 进行更新。您还可以指定要比较的属性。

🏃‍♂️‍**步骤**

1. 检查是否在库配置对话框中选择了所有要比较的属性。

2. 在 CIS 选项卡工具栏上，单击“部分...”按钮以激活比较。

   > [!TIP]
   >
   > 比较是基于 CIS 属性 Part\_Number 进行的。

3. 在“元件属性信息”区域中检查搜索结果，其中错误以红色突出显示。您还可以：

   - 使用筛选条件通过参考指示器、原理图图页、元件编号、错误类型或仅显示错误按钮搜索特定元件。

     > [!INFO]
     >
     > 按组件名称或元件编号进行过滤区分大小写，并且当前不支持通配符或表达式。

   - 单击表中的任何项目，然后在“比较结果”区域中查看设计和 CIS 中分配的相应属性值，其中差异以红色突出显示。

4. 通过以下任一方式从 CIS 更新不一致的原理图元件属性，这仅对发现“属性不相等”错误的元件有效。

   - 单击“全部更新”可从 CIS 中更新所有不一致的元件属性。
   - 在表中选择一个或多个项目，然后单击“更新所选”可仅更新选定元件的不一致属性。使用 Ctrl 键可进行多项选择。
   - 更新“比较结果”区域中特定元件的属性，有两个可用选项：
     - 更新选定属性：**右键**单击属性单元格，然后单击“从 CIS 更新选定属性”弹出菜单项 
     - 更新所有属性：**右键**单击，然后单击“从 CIS 更新选定元件”弹出菜单项

## 打开已在使用的文件

SailWind 产品可帮助您避免对其他用户已打开的文件进行更改。

在共享位置打开文件的第一个用户将成为该文件在打开期间的所有者；该文件对所有其他用户锁定。如果您尝试打开其他人已打开的文件，您将收到一条警告消息，告知您当前所有者以及文件锁定的计算机名称。您可以选择查看文件的只读版本，但在所有者仍打开该文件时，您将无法更新它。您可以使用“另存为”将文件保存为其他名称。

使用文件操作创建并保存新的原理图文件。您还可以打开和保存现有设计、导入和导出其他文件格式的文件，以及存档原理图。

